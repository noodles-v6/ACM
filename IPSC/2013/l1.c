/* solution for labyrinth, easy input
   algorithm: bfs where the state is our position and the state of each
   button. level definitions are taken from header files from task archive.
   another feasibly solution for the easy input is to play the game
   manually. */

/* level format:
   0 wall
   1 open space
   2 our starting position
   3 goal
   1xx button
   2xx closed door
   3xx open door

   when a button is pressed, the corresponding doors toggle.
*/

#include <stdio.h>
#include <string.h>

int level0[10][10] = {
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0},
	{   0,   1, 103,   1,   1, 200, 104,   0,   3,   0},
	{   0,   1,   0,   0,   0,   1,   0,   0, 204,   0},
	{   0,   1, 202, 101,   0,   1,   0,   0, 303,   0},
	{   0,   1,   0, 106,   0,   2,   0,   0,   1,   0},
	{   0,   1,   0,   0,   0,   1,   0,   0,   1,   0},
	{   0,   1, 102,   0,   0, 100,   0,   0,   1,   0},
	{   0,   1,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1, 201,   1,   1,   1,   1, 306,   1,   0},
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0}
};

int level1[12][12] = {
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0},
	{   0, 100, 101,   0,   0,   0,   1,   1,   1,   1, 201,   0},
	{   0,   2,   1,   1,   1,   0,   1,   0,   0,   0, 104,   0},
	{   0, 102, 103,   0, 202,   0,   1,   0,   0,   0,   0,   0},
	{   0,   0,   0,   0,   1,   0,   1,   0,   0,   0,   3,   0},
	{   0,   1,   1,   1,   1,   0,   1,   0,   1,   1, 204,   0},
	{   0,   1,   0,   0,   0,   0,   1,   0,   1,   0,   0,   0},
	{   0,   1, 202, 205, 303,   1,   1,   0,   1,   0,   0,   0},
	{   0,   1,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0},
	{   0,   1,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0},
	{   0,   1, 203,   1,   1,   1,   1,   1,   1,   1, 105,   0},
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0}
};

int level2[15][25] = {
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0},
	{   0,   0,   0,   0,   0,   0,   0, 100,   0,   0,   0,   0,   0, 109,   0, 105,   0,   0,   0,   0,   0,   0,   0,   3,   0},
	{   0,   3,   0,   0,   0,   0,   0,   1,   0, 113,   0, 106,   0, 208,   0, 302,   0,   0,   0,   0,   0,   0,   0, 312,   0},
	{   0, 211,   0, 102,   1,   1, 201,   1, 301, 112,   0, 303,   0, 207,   0,   1,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1,   0,   0,   0,   0,   0,   1,   0,   0,   0,   1,   0,   1,   0,   1,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1,   1,   1, 110,   0,   0,   1,   0,   0,   0,   1,   0,   1,   0,   1,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1,   0,   0,   0,   0,   1,   1,   1,   0,   0,   1,   0,   1,   0,   1,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1,   0, 104,   1, 202,   1,   2,   1, 204,   1,   1,   1,   1,   1,   1,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1,   0,   0,   0,   0,   1,   1,   1,   0,   0,   0,   0,   1,   0,   1,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1,   1,   1,   1,   1, 209,   1,   0,   0,   0,   0,   0,   1,   0,   1,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   1,   0,   1,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1,   0, 103, 205,   1, 300,   1, 200,   1,   1, 203,   0, 206,   0,   1,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1,   0,   0,   0,   0,   0,   1,   0,   0,   0, 107,   0, 108,   0, 210,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   0,   0,   0,   0,   0,   0, 101,   0,   0,   0,   0,   0,   0,   0,   1,   1,   1,   1,   1,   1,   1, 213,   1,   0},
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0}
};

int level3[17][17] = {
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0},
	{   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0},
	{   0,   1,   2,   1, 300,   1, 100,   1, 200,   1, 101,   1, 202,   1, 103,   1,   0},
	{   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0},
	{   0,   0, 207,   0,   0,   0, 201,   0,   0,   0, 209,   0,   0,   0, 211,   0,   0},
	{   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0},
	{   0,   1, 104,   1, 317,   1, 102,   1, 207,   1, 110,   1, 215,   1, 111,   1,   0},
	{   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0},
	{   0,   0, 203,   0,   0,   0, 207,   0,   0,   0, 214,   0,   0,   0, 311,   0,   0},
	{   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0},
	{   0,   1, 109,   1, 316,   1, 108,   1, 219,   1,   3,   1, 211,   1, 112,   1,   0},
	{   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0},
	{   0,   0, 304,   0,   0,   0, 206,   0,   0,   0, 207,   0,   0,   0, 210,   0,   0},
	{   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0},
	{   0,   1, 106,   1, 204,   1, 116,   1, 209,   1, 113,   1, 208,   1, 109,   1,   0},
	{   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0},
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0}
};

int level4[19][19] = {
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0},
	{   0,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   0, 102,   0},
	{   0,   0,   0,   0,   0,   1,   0,   1,   0,   0,   0,   1,   0,   0,   0,   0,   0, 201,   0},
	{   0,   2,   1,   1,   0, 100,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0},
	{   0,   0,   0,   1,   0,   0,   0,   0,   0,   1,   0,   0,   0,   1,   0,   1,   0,   0,   0},
	{   0, 103, 202,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0},
	{   0,   0,   0,   0,   0,   1,   0,   1,   0,   0,   0,   1,   0,   0,   0,   1,   0,   1,   0},
	{   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   0,   1,   1,   1,   1,   1,   0,   1,   0},
	{   0,   1,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   1,   1,   1,   1,   0,   1,   1,   1,   0},
	{   0,   1,   0,   1,   0,   1,   0,   1,   0,   1,   0,   0,   0,   1,   0,   1,   0,   1,   0},
	{   0,   1,   0,   1,   1,   1,   0,   1,   0,   1,   1,   0,   0,   1,   1,   1,   0,   1,   0},
	{   0,   1,   0,   0,   0,   0,   0,   1,   0,   0,   1,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1,   1,   1,   0,   1,   1,   1,   1,   1,   1,   0,   1,   1,   1,   1,   0, 200,   0},
	{   0,   1,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   1,   0, 101,   0},
	{   0,   1,   0,   1,   1,   1,   1,   1,   0,   1,   1,   1,   1,   0,   1,   1,   0,   0,   0},
	{   0,   1,   0,   0,   0,   1,   0,   0,   0,   1,   0,   0,   0,   0, 205,   0,   0,   3,   0},
	{   0,   1, 204, 105,   0,   1,   1,   1,   1,   1, 203, 104,   0,   1,   1,   1,   1,   1,   0},
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0}
};

int level5[17][14] = {
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0},
	{   0,   0,   0,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   0},
	{   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0},
	{   0,   1, 202,   1,   0,   1,   1,   1,   1,   1,   0,   1,   1,   0},
	{   0,   1, 300,   1,   0,   1,   0,   0,   0,   1,   0,   1,   0,   0},
	{   0,   1, 203,   1,   0,   1,   0,   0,   0,   1,   0,   1,   1,   0},
	{   0,   1,   0,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   0},
	{   0,   1,   0,   0,   1,   1,   1,   0, 203, 200, 202,   0,   1,   0},
	{   0,   1,   1,   0, 302, 200, 201,   0,   1,   1,   1,   0,   1,   0},
	{   0,   0,   1,   0,   1,   1,   1,   0,   1,   1,   1,   0,   1,   0},
	{   0,   1,   1,   0, 302, 203, 201,   0, 201, 302, 200,   0,   1,   0},
	{   0,   1,   0,   0,   1,   1,   1,   0,   1,   1,   1,   0,   3,   0},
	{   0,   1,   0,   0,   0,   1,   0,   0,   1,   1,   1,   0,   0,   0},
	{   0,   1,   1, 200,   1,   1,   0, 100,   1,   1,   1, 102,   0,   0},
	{   0,   1,   1, 203,   1,   1,   0,   0,   1,   1,   1,   0,   0,   0},
	{   0,   0,   1, 201,   1,   0,   0, 101,   1,   2,   1, 103,   0,   0},
	{   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0}
};

int level6[24][5] = {
	{   0,   0,   0,   0,   0},
	{   0,   0, 100,   0,   0},
	{   0, 101,   2, 103,   0},
	{   0, 102,   1, 104,   0},
	{   0,   0,   1,   0,   0},
	{   0,   1,   1,   1,   0},
	{   0, 202, 201, 300,   0},
	{   0,   1,   1,   1,   0},
	{   0, 203, 202, 304,   0},
	{   0,   1,   1,   1,   0},
	{   0, 303, 301, 304,   0},
	{   0,   1,   1,   1,   0},
	{   0, 301, 304, 202,   0},
	{   0,   1,   1,   1,   0},
	{   0, 301, 200, 204,   0},
	{   0,   1,   1,   1,   0},
	{   0, 200, 202, 301,   0},
	{   0,   1,   1,   1,   0},
	{   0, 204, 202, 200,   0},
	{   0,   1,   1,   1,   0},
	{   0, 201, 204, 203,   0},
	{   0,   1,   1,   1,   0},
	{   0,   0,   3,   0,   0},
	{   0,   0,   0,   0,   0}
};

int heights[7] = {10, 12, 15, 17, 19, 17, 24};
int widths[7] = {10, 12, 25, 17, 19, 14, 5};

#define MAXKEY 15
#define MAXQ 70000000
#define MAXX 25
#define MAXY 24

int q[MAXQ],qs,qe;
signed char prev[MAXX][MAXY][1<<MAXKEY];
char sol[MAXQ];
int sn;

int level[MAXX][MAXY];
int x,y;
int dx[]={1,0,-1,0};
int dy[]={0,1,0,-1};
char dir[]="RDLU";

void bfs() {
	int curx,cury,curk,x2,y2,k2,i,j,d,door;
	qs=qe=0;
	memset(prev,-1,sizeof(prev));
	/* find starting position */
	for(i=0;i<x;i++) for(j=0;j<y;j++) if(level[i][j]==2) q[qe++]=i,q[qe++]=j,q[qe++]=0,prev[i][j][0]=0;
	while(qs<qe) {
		curx=q[qs++]; cury=q[qs++]; curk=q[qs++];
		for(d=0;d<4;d++) {
			x2=curx+dx[d]; y2=cury+dy[d]; k2=curk;
			if(x2<0 || y2<0 || x2>=x || y2>=y || !level[x2][y2] || prev[x2][y2][k2]>-1) continue;
			/* don't enter closed door */
			if(level[x2][y2]>=200) {
				door=level[x2][y2]%100;
				if((level[x2][y2]-200)/100==((k2>>door)&1)) continue;
			}
			q[qe++]=x2; q[qe++]=y2; q[qe++]=k2;
			prev[x2][y2][k2]=dir[d];
			if(level[x2][y2]==3) goto solved;
		}
		/* toggle button */
		if(level[curx][cury]>=100 && level[curx][cury]<200) {
			door=level[curx][cury]-100;
			x2=curx; y2=cury; k2=curk^(1<<door);
			if(prev[x2][y2][k2]>-1) continue;
			q[qe++]=x2; q[qe++]=y2; q[qe++]=k2;
			prev[x2][y2][k2]='P';
		}
	}
	printf("sanity error, couldn't find solution.\n");
	return;
solved:
	sn=0;
	while(prev[x2][y2][k2]) {
		sol[sn++]=prev[x2][y2][k2];
		switch(prev[x2][y2][k2]) {
		case 'L':
			x2++;
			break;
		case 'R':
			x2--;
			break;
		case 'U':
			y2++;
			break;
		case 'D':
			y2--;
			break;
		case 'P':
			k2^=1<<(level[x2][y2]%100);
		}
	}
	while(--sn>-1) putchar(sol[sn]);
	putchar('\n');
}

int main() {
	int i,j,T=0;
	/* level 1 */
	x=widths[T]; y=heights[T];
	for(i=0;i<x;i++) for(j=0;j<y;j++) level[i][j]=level0[j][i];
	bfs();
	T++;
	/* level 2 */
	x=widths[T]; y=heights[T];
	for(i=0;i<x;i++) for(j=0;j<y;j++) level[i][j]=level1[j][i];
	bfs();
	T++;
	/* level 3 */
	x=widths[T]; y=heights[T];
	for(i=0;i<x;i++) for(j=0;j<y;j++) level[i][j]=level2[j][i];
	bfs();
	T++;
	/* level 4 */
	x=widths[T]; y=heights[T];
	for(i=0;i<x;i++) for(j=0;j<y;j++) level[i][j]=level3[j][i];
	bfs();
	T++;
	/* level 5 */
	x=widths[T]; y=heights[T];
	for(i=0;i<x;i++) for(j=0;j<y;j++) level[i][j]=level4[j][i];
	bfs();
	T++;
	/* level 6 */
	x=widths[T]; y=heights[T];
	for(i=0;i<x;i++) for(j=0;j<y;j++) level[i][j]=level5[j][i];
	bfs();
	T++;
	/* level 7 */
	x=widths[T]; y=heights[T];
	for(i=0;i<x;i++) for(j=0;j<y;j++) level[i][j]=level6[j][i];
	bfs();
	return 0;
}
